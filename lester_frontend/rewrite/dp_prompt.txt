
The generated code did not execute correctly, but produced the following error:

OneHotEncoder.__init__() got an unexpected keyword argument 'sparse'

Please rewrite the code to fix this error. Here is the code with the error that needs to be rewritten:


def __featurise():
    import numpy as np
    from sklearn.preprocessing import StandardScaler, OneHotEncoder, FunctionTransformer
    from sklearn.pipeline import Pipeline, FeatureUnion
    from sklearn.compose import ColumnTransformer
    from sentence_transformers import SentenceTransformer

    # Initialize the sentence embedder
    sentence_embedder = SentenceTransformer("all-mpnet-base-v2")

    # Define transformers
    def embed_sentences(titles):
        return sentence_embedder.encode(titles)

    sentence_embedding_transformer = FunctionTransformer(embed_sentences, validate=False)

    def compute_title_length(titles):
        return np.array([len(title) for title in titles]).reshape(-1, 1)

    title_length_transformer = Pipeline([
        ('length', FunctionTransformer(compute_title_length, validate=False)),
        ('scaler', StandardScaler())
    ])

    country_indices = {'DE': 0, 'FR': 1, 'UK': 2}
    country_onehot_transformer = OneHotEncoder(categories=[list(country_indices.keys())], sparse=False)

    # ColumnTransformer
    column_transformer = ColumnTransformer(transformers=[
        ('subject_embeddings', sentence_embedding_transformer, 'title'),
        ('text_embeddings', sentence_embedding_transformer, 'text'),
        ('title_length', title_length_transformer, 'title'),
        ('country_onehot', country_onehot_transformer, ['country'])
    ])

    return column_transformer


ONLY RESPOND WITH PYTHON CODE. DO NOT CHANGE THE SEMANTICS OF THE CODE. RETURN THE FULL CODE FOR THE TASK!!!
